<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: MediaSetsController
  
    &mdash; Documentation by YARD 0.7.4
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '';
  if (relpath != '') relpath += '/';
</script>

  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index (M)</a> &raquo; 
    
    
    <span class="title">MediaSetsController</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a id="class_list_link" href="#">Class List</a>
  
    <a id="method_list_link" href="#">Method List</a>
  
    <a id="file_list_link" href="#">File List</a>
  
</div>
      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Class: MediaSetsController
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="ApplicationController.html" title="ApplicationController (class)">ApplicationController</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">ActionController::Base</li>
          
            <li class="next"><span class='object_link'><a href="ApplicationController.html" title="ApplicationController (class)">ApplicationController</a></span></li>
          
            <li class="next">MediaSetsController</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">app/controllers/media_sets_controller.rb</dd>
  
</dl>
<div class="clear"></div>



  
  
  
  
  


  
  
  
  

  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#abstract-instance_method" title="#abstract (instance method)">- (Object) <strong>abstract</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
TODO only for media_project.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_member-instance_method" title="#add_member (instance method)">- (Object) <strong>add_member</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#browse-instance_method" title="#browse (instance method)">- (Object) <strong>browse</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
TODO only for media_project.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create-instance_method" title="#create (instance method)">- (Object) <strong>create</strong>(attr = params[:media_set]) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
API # POST &#8220;/media_sets&#8221;, {meta_data_attributes: {0
=> {meta_key_id: 3, value: &#8220;Set title&#8221;}} } POST
&#8220;/media_sets&#8221;, {0: {meta_data_attributes: {0 =>
{meta_key_id: 3, value: &#8220;Set title&#8221;}},
</p>
<pre class="code">
                                 1: {meta_data_attributes: {0 =&gt; {meta_key_id: 3, value: &quot;Set title&quot;}}} }}.</pre>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#destroy-instance_method" title="#destroy (instance method)">- (Object) <strong>destroy</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#edit-instance_method" title="#edit (instance method)">- (Object) <strong>edit</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#index-instance_method" title="#index (instance method)">- (Object) <strong>index</strong>(accessible_action = params[:accessible_action] || :view, with = params[:with]) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
API # GET &#8220;/media_sets.js&#8221;, {}
</p>
<h1>> RETURNS 1, title: &#8220;ABC&#8221;, 2, title: &#8220;CDF&#8221;}</h1>
<p>
GET &#8220;/media_sets.js&#8221;, &#8220;edit&#8221;
</p>
<h1>> RETURNS 1, title: &#8220;ABC&#8221;, 2, title: &#8220;CDF&#8221;} # NOTE: but only editable sets</h1>
<p>
GET &#8220;/media_sets.js&#8221;, &#8220;edit&#8221;,
with: {set: {child_sets: {}}}
</p>
<h1>> RETURNS 1, title: &#8220;ABC&#8221;, child_sets: {}, 2, title: &#8220;CDF&#8221;, child_sets: {{id: 4, title: &#8220;XYZ&#8221;}}} # NOTE: but only editable sets.</h1>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#inheritable_contexts-instance_method" title="#inheritable_contexts (instance method)">- (Object) <strong>inheritable_contexts</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#parents-instance_method" title="#parents (instance method)">- (Object) <strong>parents</strong>(media_set_ids = params[:media_set_ids]) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
TODO merge with media_entries_controller#media_sets ?? OR merge to parents
using the inverse nesting ?? API # POST
&#8220;/media_sets/:id/parents&#8221;, {media_set_ids: [1, 2, 3, &#8220;My
new parent set&#8221;] } DELETE &#8220;/media_sets/:id/parents&#8221;,
{media_set_ids: [1, 2, 3] }.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#show-instance_method" title="#show (instance method)">- (Object) <strong>show</strong>(options_for_media_entries = params[:options_for_media_entries], thumb = params[:thumb]) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
API # get nested media_entries: GET &#8220;/media_sets/:id.js&#8221;.
</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="ApplicationController.html" title="ApplicationController (class)">ApplicationController</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="ApplicationController.html#_-instance_method" title="ApplicationController#_ (method)">#_</a></span>, <span class='object_link'><a href="ApplicationController.html#catalog-instance_method" title="ApplicationController#catalog (method)">#catalog</a></span>, <span class='object_link'><a href="ApplicationController.html#current_user-instance_method" title="ApplicationController#current_user (method)">#current_user</a></span>, <span class='object_link'><a href="ApplicationController.html#feedback-instance_method" title="ApplicationController#feedback (method)">#feedback</a></span>, <span class='object_link'><a href="ApplicationController.html#help-instance_method" title="ApplicationController#help (method)">#help</a></span>, <span class='object_link'><a href="ApplicationController.html#logged_in%3F-instance_method" title="ApplicationController#logged_in? (method)">#logged_in?</a></span>, <span class='object_link'><a href="ApplicationController.html#root-instance_method" title="ApplicationController#root (method)">#root</a></span></p>

  

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="abstract-instance_method">
  
    - (<tt>Object</tt>) <strong>abstract</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
TODO only for media_project
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


88
89
90
91
92
93</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/media_sets_controller.rb', line 88</span>

<span class='kw'>def</span> <span class='id identifier rubyid_abstract'>abstract</span>
  <span class='ivar'>@_media_entry_ids</span> <span class='op'>=</span> <span class='const'>MediaResource</span><span class='period'>.</span><span class='id identifier rubyid_accessible_by_user'>accessible_by_user</span><span class='lparen'>(</span><span class='id identifier rubyid_current_user'>current_user</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_media_entries'>media_entries</span><span class='period'>.</span><span class='id identifier rubyid_by_media_set'>by_media_set</span><span class='lparen'>(</span><span class='ivar'>@media_set</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:id</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_respond_to'>respond_to</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_format'>format</span><span class='op'>|</span>
    <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_js'>js</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_render'>render</span> <span class='symbol'>:layout</span> <span class='op'>=&gt;</span> <span class='kw'>false</span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="add_member-instance_method">
  
    - (<tt>Object</tt>) <strong>add_member</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/media_sets_controller.rb', line 175</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_member'>add_member</span>
  <span class='kw'>if</span> <span class='ivar'>@media_set</span>
    <span class='id identifier rubyid_new_members'>new_members</span> <span class='op'>=</span> <span class='int'>0</span> <span class='comment'>#temp#
</span>    <span class='comment'>#raise params[:media_entry_ids].inspect
</span>    <span class='kw'>if</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:media_entry_ids</span><span class='rbracket'>]</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:media_entry_ids</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>null</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='comment'>#check for blank submission from select
</span>      <span class='id identifier rubyid_ids'>ids</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:media_entry_ids</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>String</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:media_entry_ids</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>,</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>:</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:media_entry_ids</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_media_entries'>media_entries</span> <span class='op'>=</span> <span class='const'>MediaEntry</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_ids'>ids</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_new_members'>new_members</span> <span class='op'>=</span> <span class='ivar'>@media_set</span><span class='period'>.</span><span class='id identifier rubyid_media_entries'>media_entries</span><span class='period'>.</span><span class='id identifier rubyid_push_uniq'>push_uniq</span><span class='lparen'>(</span><span class='id identifier rubyid_media_entries'>media_entries</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_flash'>flash</span><span class='lbracket'>[</span><span class='symbol'>:notice</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_new_members'>new_members</span> <span class='op'>&gt;</span> <span class='int'>1</span>
       <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_new_members'>new_members</span><span class='rbrace'>}</span><span class='tstring_content'> neue Medieneinträge wurden dem Set/Projekt </span><span class='embexpr_beg'>#{</span><span class='ivar'>@media_set</span><span class='period'>.</span><span class='id identifier rubyid_title'>title</span><span class='rbrace'>}</span><span class='tstring_content'> hinzugefügt</span><span class='tstring_end'>&quot;</span></span> 
    <span class='kw'>elsif</span> <span class='id identifier rubyid_new_members'>new_members</span> <span class='op'>==</span> <span class='int'>1</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Ein neuer Medieneintrag wurde dem Set/Projekt </span><span class='embexpr_beg'>#{</span><span class='ivar'>@media_set</span><span class='period'>.</span><span class='id identifier rubyid_title'>title</span><span class='rbrace'>}</span><span class='tstring_content'> hinzugefügt</span><span class='tstring_end'>&quot;</span></span> 
    <span class='kw'>else</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Es wurden keine neuen Medieneinträge hinzugefügt.</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_respond_to'>respond_to</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_format'>format</span><span class='op'>|</span>
      <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span> <span class='lbrace'>{</span> 
        <span class='kw'>unless</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:media_entry_ids</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>null</span><span class='tstring_end'>&quot;</span></span> <span class='comment'># check for blank submission of batch edit form.
</span>          <span class='id identifier rubyid_redirect_to'>redirect_to</span><span class='lparen'>(</span><span class='ivar'>@media_set</span><span class='rparen'>)</span> 
        <span class='kw'>else</span>
          <span class='id identifier rubyid_flash'>flash</span><span class='lbracket'>[</span><span class='symbol'>:error</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Keine Medieneinträge ausgewählt</span><span class='tstring_end'>&quot;</span></span>
          <span class='id identifier rubyid_redirect_to'>redirect_to</span> <span class='ivar'>@media_set</span>
        <span class='kw'>end</span>
        <span class='rbrace'>}</span> <span class='comment'># OPTIMIZE
</span><span class='comment'>#temp3#
</span><span class='comment'>#        format.js { 
</span><span class='comment'>#          render :update do |page|
</span><span class='comment'>#            page.replace_html 'flash', flash_content
</span><span class='comment'>#          end
</span><span class='comment'>#        }
</span>    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='ivar'>@media_sets</span> <span class='op'>=</span> <span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_media_sets'>media_sets</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="browse-instance_method">
  
    - (<tt>Object</tt>) <strong>browse</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
TODO only for media_project
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


96
97
98
99
100
101
102</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/media_sets_controller.rb', line 96</span>

<span class='kw'>def</span> <span class='id identifier rubyid_browse'>browse</span>
  <span class='ivar'>@project</span> <span class='op'>=</span> <span class='ivar'>@media_set</span>
  <span class='id identifier rubyid_respond_to'>respond_to</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_format'>format</span><span class='op'>|</span>
    <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span>
    <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_js'>js</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_render'>render</span> <span class='symbol'>:layout</span> <span class='op'>=&gt;</span> <span class='kw'>false</span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="create-instance_method">
  
    - (<tt>Object</tt>) <strong>create</strong>(attr = params[:media_set]) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
API # POST &#8220;/media_sets&#8221;, {meta_data_attributes: {0
=> {meta_key_id: 3, value: &#8220;Set title&#8221;}} } POST
&#8220;/media_sets&#8221;, {0: {meta_data_attributes: {0 =>
{meta_key_id: 3, value: &#8220;Set title&#8221;}},
</p>
<pre class="code">
                                 1: {meta_data_attributes: {0 =&gt; {meta_key_id: 3, value: &quot;Set title&quot;}}} }}</pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/media_sets_controller.rb', line 125</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_attr'>attr</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:media_set</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  
  <span class='id identifier rubyid_is_saved'>is_saved</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_attr'>attr</span><span class='period'>.</span><span class='id identifier rubyid_has_key?'>has_key?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>0</span><span class='tstring_end'>&quot;</span></span> <span class='comment'># CREATE MULTIPLE
</span>    <span class='comment'># TODO ?? find_by_id_or_create_by_title
</span>    <span class='ivar'>@media_sets</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span> 
    <span class='id identifier rubyid_attr'>attr</span><span class='period'>.</span><span class='id identifier rubyid_each_pair'>each_pair</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span>
      <span class='id identifier rubyid_media_set'>media_set</span> <span class='op'>=</span> <span class='id identifier rubyid_current_user'>current_user</span><span class='period'>.</span><span class='id identifier rubyid_media_sets'>media_sets</span><span class='period'>.</span><span class='id identifier rubyid_build'>build</span><span class='lparen'>(</span><span class='id identifier rubyid_v'>v</span><span class='rparen'>)</span>
      <span class='ivar'>@media_sets</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_media_set'>media_set</span>
      <span class='id identifier rubyid_is_saved'>is_saved</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_is_saved'>is_saved</span> <span class='kw'>and</span> <span class='id identifier rubyid_media_set'>media_set</span><span class='period'>.</span><span class='id identifier rubyid_save'>save</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span> <span class='comment'># CREATE SINGLE
</span>    <span class='ivar'>@media_set</span> <span class='op'>=</span> <span class='id identifier rubyid_current_user'>current_user</span><span class='period'>.</span><span class='id identifier rubyid_media_sets'>media_sets</span><span class='period'>.</span><span class='id identifier rubyid_build'>build</span><span class='lparen'>(</span><span class='id identifier rubyid_attr'>attr</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_is_saved'>is_saved</span> <span class='op'>=</span> <span class='ivar'>@media_set</span><span class='period'>.</span><span class='id identifier rubyid_save'>save</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_respond_to'>respond_to</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_format'>format</span><span class='op'>|</span>
    <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span> <span class='lbrace'>{</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_is_saved'>is_saved</span>
        <span class='id identifier rubyid_redirect_to'>redirect_to</span> <span class='id identifier rubyid_user_resources_path'>user_resources_path</span><span class='lparen'>(</span><span class='id identifier rubyid_current_user'>current_user</span><span class='comma'>,</span> <span class='symbol'>:type</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>sets</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_flash'>flash</span><span class='lbracket'>[</span><span class='symbol'>:notice</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='ivar'>@media_set</span><span class='period'>.</span><span class='id identifier rubyid_errors'>errors</span><span class='period'>.</span><span class='id identifier rubyid_full_messages'>full_messages</span>
        <span class='id identifier rubyid_redirect_to'>redirect_to</span> <span class='symbol'>:back</span>
      <span class='kw'>end</span>
    <span class='rbrace'>}</span>
    <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_js'>js</span> <span class='lbrace'>{</span>
      <span class='id identifier rubyid_r'>r</span> <span class='op'>=</span> <span class='ivar'>@media_sets</span> <span class='op'>?</span> <span class='ivar'>@media_sets</span> <span class='op'>:</span> <span class='ivar'>@media_set</span>
      <span class='id identifier rubyid_render'>render</span> <span class='symbol'>:json</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_as_json'>as_json</span><span class='lparen'>(</span><span class='symbol'>:user</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_current_user'>current_user</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='symbol'>:status</span> <span class='op'>=&gt;</span> <span class='lparen'>(</span><span class='id identifier rubyid_is_saved'>is_saved</span> <span class='op'>?</span> <span class='int'>200</span> <span class='op'>:</span> <span class='int'>500</span><span class='rparen'>)</span>
    <span class='rbrace'>}</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="destroy-instance_method">
  
    - (<tt>Object</tt>) <strong>destroy</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


162
163
164
165
166
167
168
169
170</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/media_sets_controller.rb', line 162</span>

<span class='kw'>def</span> <span class='id identifier rubyid_destroy'>destroy</span>
  <span class='comment'># TODO ACL
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:media_set_id</span><span class='rbracket'>]</span>
    <span class='ivar'>@media_set</span><span class='period'>.</span><span class='id identifier rubyid_destroy'>destroy</span>
  <span class='kw'>end</span>
   <span class='id identifier rubyid_respond_to'>respond_to</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_format'>format</span><span class='op'>|</span>
     <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_redirect_to'>redirect_to</span> <span class='id identifier rubyid_user_resources_path'>user_resources_path</span><span class='lparen'>(</span><span class='id identifier rubyid_current_user'>current_user</span><span class='comma'>,</span> <span class='symbol'>:type</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>sets</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='rbrace'>}</span>
   <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="edit-instance_method">
  
    - (<tt>Object</tt>) <strong>edit</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


159
160</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/media_sets_controller.rb', line 159</span>

<span class='kw'>def</span> <span class='id identifier rubyid_edit'>edit</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="index-instance_method">
  
    - (<tt>Object</tt>) <strong>index</strong>(accessible_action = params[:accessible_action] || :view, with = params[:with]) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
API # GET &#8220;/media_sets.js&#8221;, {}
</p>
<h1>> RETURNS 1, title: &#8220;ABC&#8221;, 2, title: &#8220;CDF&#8221;}</h1>
<p>
GET &#8220;/media_sets.js&#8221;, &#8220;edit&#8221;
</p>
<h1>> RETURNS 1, title: &#8220;ABC&#8221;, 2, title: &#8220;CDF&#8221;} # NOTE: but only editable sets</h1>
<p>
GET &#8220;/media_sets.js&#8221;, &#8220;edit&#8221;,
with: {set: {child_sets: {}}}
</p>
<h1>> RETURNS 1, title: &#8220;ABC&#8221;, child_sets: {}, 2, title: &#8220;CDF&#8221;, child_sets: {{id: 4, title: &#8220;XYZ&#8221;}}} # NOTE: but only editable sets</h1>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/media_sets_controller.rb', line 20</span>

<span class='kw'>def</span> <span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='id identifier rubyid_accessible_action'>accessible_action</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:accessible_action</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='symbol'>:view</span><span class='comma'>,</span>
          <span class='id identifier rubyid_with'>with</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:with</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_respond_to'>respond_to</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_format'>format</span><span class='op'>|</span>
    <span class='comment'>#-# only used for FeaturedSet
</span>    <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span> <span class='lbrace'>{</span>
      <span class='id identifier rubyid_resources'>resources</span> <span class='op'>=</span> <span class='const'>MediaResource</span><span class='period'>.</span><span class='id identifier rubyid_accessible_by_user'>accessible_by_user</span><span class='lparen'>(</span><span class='id identifier rubyid_current_user'>current_user</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_media_sets'>media_sets</span>
  
      <span class='ivar'>@media_sets</span><span class='comma'>,</span> <span class='ivar'>@my_media_sets</span><span class='comma'>,</span> <span class='ivar'>@my_title</span><span class='comma'>,</span> <span class='ivar'>@other_title</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='ivar'>@media_set</span>
        <span class='comment'># all media_sets I can see, nested within a media set (for now only used with featured sets)
</span>        <span class='lbracket'>[</span><span class='id identifier rubyid_resources'>resources</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='symbol'>:id</span> <span class='op'>=&gt;</span> <span class='ivar'>@media_set</span><span class='period'>.</span><span class='id identifier rubyid_child_sets'>child_sets</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@media_set</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='kw'>nil</span><span class='rbracket'>]</span>
      <span class='kw'>elsif</span> <span class='ivar'>@user</span> <span class='kw'>and</span> <span class='ivar'>@user</span> <span class='op'>!=</span> <span class='id identifier rubyid_current_user'>current_user</span>
        <span class='comment'># all media_sets I can see that have been created by another user
</span>        <span class='lbracket'>[</span><span class='id identifier rubyid_resources'>resources</span><span class='period'>.</span><span class='id identifier rubyid_by_user'>by_user</span><span class='lparen'>(</span><span class='ivar'>@user</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Sets von %s</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='ivar'>@user</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='rbracket'>]</span>
      <span class='kw'>else</span> <span class='comment'># TODO elsif @user == current_user
</span>        <span class='comment'># all media sets I can see that have not been created by me
</span>        <span class='id identifier rubyid_other'>other</span> <span class='op'>=</span> <span class='id identifier rubyid_resources'>resources</span><span class='period'>.</span><span class='id identifier rubyid_not_by_user'>not_by_user</span><span class='lparen'>(</span><span class='id identifier rubyid_current_user'>current_user</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_my'>my</span> <span class='op'>=</span> <span class='id identifier rubyid_resources'>resources</span><span class='period'>.</span><span class='id identifier rubyid_by_user'>by_user</span><span class='lparen'>(</span><span class='id identifier rubyid_current_user'>current_user</span><span class='rparen'>)</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:type</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>projects</span><span class='tstring_end'>&quot;</span></span>
          <span class='lbracket'>[</span><span class='id identifier rubyid_other'>other</span><span class='period'>.</span><span class='id identifier rubyid_projects'>projects</span><span class='comma'>,</span> <span class='id identifier rubyid_my'>my</span><span class='period'>.</span><span class='id identifier rubyid_projects'>projects</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Meine Projekte</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Weitere Projekte</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
        <span class='kw'>else</span>
          <span class='lbracket'>[</span><span class='id identifier rubyid_other'>other</span><span class='period'>.</span><span class='id identifier rubyid_sets'>sets</span><span class='comma'>,</span> <span class='id identifier rubyid_my'>my</span><span class='period'>.</span><span class='id identifier rubyid_sets'>sets</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Meine Sets</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Weitere Sets</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='rbrace'>}</span>
    <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_js'>js</span> <span class='lbrace'>{</span>
      <span class='id identifier rubyid_sets'>sets</span> <span class='op'>=</span> <span class='const'>MediaResource</span><span class='period'>.</span><span class='id identifier rubyid_accessible_by_user'>accessible_by_user</span><span class='lparen'>(</span><span class='id identifier rubyid_current_user'>current_user</span><span class='comma'>,</span> <span class='id identifier rubyid_accessible_action'>accessible_action</span><span class='period'>.</span><span class='id identifier rubyid_to_sym'>to_sym</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_media_sets'>media_sets</span>
      <span class='id identifier rubyid_render'>render</span> <span class='symbol'>:json</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_sets'>sets</span><span class='period'>.</span><span class='id identifier rubyid_as_json'>as_json</span><span class='lparen'>(</span><span class='symbol'>:user</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_current_user'>current_user</span><span class='comma'>,</span> <span class='symbol'>:with</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_with'>with</span><span class='comma'>,</span> <span class='symbol'>:with_thumb</span> <span class='op'>=&gt;</span> <span class='kw'>false</span><span class='rparen'>)</span> <span class='comment'># TODO drop with_thum merge with with
</span>    <span class='rbrace'>}</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="inheritable_contexts-instance_method">
  
    - (<tt>Object</tt>) <strong>inheritable_contexts</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


106
107
108
109
110
111
112
113
114
115</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/media_sets_controller.rb', line 106</span>

<span class='kw'>def</span> <span class='id identifier rubyid_inheritable_contexts'>inheritable_contexts</span>
  <span class='ivar'>@inheritable_contexts</span> <span class='op'>=</span> <span class='ivar'>@media_set</span><span class='period'>.</span><span class='id identifier rubyid_inheritable_contexts'>inheritable_contexts</span>
  <span class='id identifier rubyid_respond_to'>respond_to</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_format'>format</span><span class='op'>|</span>
    <span class='comment'>#format.js { render :json =&gt; @inheritable_contexts}
</span>    <span class='comment'>#format.html{render :text =&gt; &quot;Use JSON&quot;, :status =&gt; 406}
</span>    <span class='comment'>#format.html{render :text =&gt; &quot;Use JSON&quot;}
</span>    <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_json'>json</span><span class='lbrace'>{</span><span class='id identifier rubyid_render'>render</span> <span class='symbol'>:json</span> <span class='op'>=&gt;</span> <span class='ivar'>@inheritable_contexts</span><span class='rbrace'>}</span>
  <span class='kw'>end</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="parents-instance_method">
  
    - (<tt>Object</tt>) <strong>parents</strong>(media_set_ids = params[:media_set_ids]) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
TODO merge with media_entries_controller#media_sets ?? OR merge to parents
using the inverse nesting ?? API # POST
&#8220;/media_sets/:id/parents&#8221;, {media_set_ids: [1, 2, 3, &#8220;My
new parent set&#8221;] } DELETE &#8220;/media_sets/:id/parents&#8221;,
{media_set_ids: [1, 2, 3] }
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/media_sets_controller.rb', line 216</span>

<span class='kw'>def</span> <span class='id identifier rubyid_parents'>parents</span><span class='lparen'>(</span><span class='id identifier rubyid_media_set_ids'>media_set_ids</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:media_set_ids</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_post?'>post?</span>
    <span class='const'>Media</span><span class='op'>::</span><span class='const'>Set</span><span class='period'>.</span><span class='id identifier rubyid_find_by_id_or_create_by_title'>find_by_id_or_create_by_title</span><span class='lparen'>(</span><span class='id identifier rubyid_media_set_ids'>media_set_ids</span><span class='comma'>,</span> <span class='id identifier rubyid_current_user'>current_user</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_media_set'>media_set</span><span class='op'>|</span>
      <span class='kw'>next</span> <span class='kw'>unless</span> <span class='const'>Permission</span><span class='period'>.</span><span class='id identifier rubyid_authorized?'>authorized?</span><span class='lparen'>(</span><span class='id identifier rubyid_current_user'>current_user</span><span class='comma'>,</span> <span class='symbol'>:edit</span><span class='comma'>,</span> <span class='id identifier rubyid_media_set'>media_set</span><span class='rparen'>)</span> <span class='comment'># (MediaSet ACL!)
</span>      <span class='ivar'>@media_set</span><span class='period'>.</span><span class='id identifier rubyid_parent_sets'>parent_sets</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_media_set'>media_set</span>
    <span class='kw'>end</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_delete?'>delete?</span>
    <span class='const'>Media</span><span class='op'>::</span><span class='const'>Set</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_media_set_ids'>media_set_ids</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_media_set'>media_set</span><span class='op'>|</span>
      <span class='kw'>next</span> <span class='kw'>unless</span> <span class='const'>Permission</span><span class='period'>.</span><span class='id identifier rubyid_authorized?'>authorized?</span><span class='lparen'>(</span><span class='id identifier rubyid_current_user'>current_user</span><span class='comma'>,</span> <span class='symbol'>:edit</span><span class='comma'>,</span> <span class='id identifier rubyid_media_set'>media_set</span><span class='rparen'>)</span> <span class='comment'># (MediaSet ACL!)
</span>      <span class='ivar'>@media_set</span><span class='period'>.</span><span class='id identifier rubyid_parent_sets'>parent_sets</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_media_set'>media_set</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  
  <span class='id identifier rubyid_respond_to'>respond_to</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_format'>format</span><span class='op'>|</span>
    <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_redirect_to'>redirect_to</span> <span class='ivar'>@media_set</span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_js'>js</span> <span class='lbrace'>{</span> 
      <span class='id identifier rubyid_render'>render</span> <span class='symbol'>:json</span> <span class='op'>=&gt;</span> <span class='ivar'>@media_set</span><span class='period'>.</span><span class='id identifier rubyid_as_json'>as_json</span><span class='lparen'>(</span><span class='symbol'>:user</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_current_user'>current_user</span><span class='comma'>,</span> <span class='symbol'>:methods</span> <span class='op'>=&gt;</span> <span class='symbol'>:parent_ids</span><span class='rparen'>)</span> 
    <span class='rbrace'>}</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="show-instance_method">
  
    - (<tt>Object</tt>) <strong>show</strong>(options_for_media_entries = params[:options_for_media_entries], thumb = params[:thumb]) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
API # get nested media_entries: GET &#8220;/media_sets/:id.js&#8220;
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/media_sets_controller.rb', line 54</span>

<span class='kw'>def</span> <span class='id identifier rubyid_show'>show</span><span class='lparen'>(</span> <span class='id identifier rubyid_options_for_media_entries'>options_for_media_entries</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:options_for_media_entries</span><span class='rbracket'>]</span><span class='comma'>,</span>
          <span class='id identifier rubyid_thumb'>thumb</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:thumb</span><span class='rbracket'>]</span><span class='rparen'>)</span>
          
  <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:per_page</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='const'>PER_PAGE</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>

  <span class='id identifier rubyid_paginate_options'>paginate_options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='symbol'>:page</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:page</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='symbol'>:per_page</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:per_page</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_resources'>resources</span> <span class='op'>=</span> <span class='const'>MediaResource</span><span class='period'>.</span><span class='id identifier rubyid_accessible_by_user'>accessible_by_user</span><span class='lparen'>(</span><span class='id identifier rubyid_current_user'>current_user</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_by_media_set'>by_media_set</span><span class='lparen'>(</span><span class='ivar'>@media_set</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_paginate'>paginate</span><span class='lparen'>(</span><span class='id identifier rubyid_paginate_options'>paginate_options</span><span class='rparen'>)</span>
  
  <span class='ivar'>@can_edit_set</span> <span class='op'>=</span> <span class='const'>Permission</span><span class='period'>.</span><span class='id identifier rubyid_authorized?'>authorized?</span><span class='lparen'>(</span><span class='id identifier rubyid_current_user'>current_user</span><span class='comma'>,</span> <span class='symbol'>:edit</span><span class='comma'>,</span> <span class='ivar'>@media_set</span><span class='rparen'>)</span>
  <span class='ivar'>@parents</span> <span class='op'>=</span> <span class='ivar'>@media_set</span><span class='period'>.</span><span class='id identifier rubyid_parent_sets'>parent_sets</span><span class='period'>.</span><span class='id identifier rubyid_as_json'>as_json</span><span class='lparen'>(</span><span class='symbol'>:user</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_current_user'>current_user</span><span class='rparen'>)</span>
  
  <span class='id identifier rubyid_respond_to'>respond_to</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_format'>format</span><span class='op'>|</span>
    <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span> <span class='lbrace'>{</span>
      <span class='id identifier rubyid_with_thumb'>with_thumb</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='ivar'>@media_entries</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='symbol'>:pagination</span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span> <span class='symbol'>:current_page</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_resources'>resources</span><span class='period'>.</span><span class='id identifier rubyid_current_page'>current_page</span><span class='comma'>,</span>
                                          <span class='symbol'>:per_page</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_resources'>resources</span><span class='period'>.</span><span class='id identifier rubyid_per_page'>per_page</span><span class='comma'>,</span>
                                          <span class='symbol'>:total_entries</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_resources'>resources</span><span class='period'>.</span><span class='id identifier rubyid_total_entries'>total_entries</span><span class='comma'>,</span>
                                          <span class='symbol'>:total_pages</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_resources'>resources</span><span class='period'>.</span><span class='id identifier rubyid_total_pages'>total_pages</span> <span class='rbrace'>}</span><span class='comma'>,</span>
                         <span class='symbol'>:entries</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_resources'>resources</span><span class='period'>.</span><span class='id identifier rubyid_as_json'>as_json</span><span class='lparen'>(</span><span class='symbol'>:user</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_current_user'>current_user</span><span class='comma'>,</span> <span class='symbol'>:with_thumb</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_with_thumb'>with_thumb</span><span class='rparen'>)</span> <span class='rbrace'>}</span> 
    <span class='rbrace'>}</span>
    <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_js'>js</span> <span class='lbrace'>{</span>
      <span class='comment'>#FE# render :json =&gt; @media_set.as_json(:user =&gt; current_user)
</span>      <span class='id identifier rubyid_json'>json</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='symbol'>:id</span> <span class='op'>=&gt;</span> <span class='ivar'>@media_set</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='symbol'>:title</span> <span class='op'>=&gt;</span> <span class='ivar'>@media_set</span><span class='period'>.</span><span class='id identifier rubyid_title'>title</span><span class='rbrace'>}</span>

      <span class='kw'>if</span> <span class='id identifier rubyid_options_for_media_entries'>options_for_media_entries</span> <span class='kw'>and</span> <span class='id identifier rubyid_options_for_media_entries'>options_for_media_entries</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'>Hash</span>
        <span class='id identifier rubyid_options_for_media_entries'>options_for_media_entries</span><span class='period'>.</span><span class='id identifier rubyid_reverse_merge!'>reverse_merge!</span><span class='lparen'>(</span><span class='symbol'>:only</span> <span class='op'>=&gt;</span> <span class='symbol'>:id</span><span class='comma'>,</span> <span class='symbol'>:methods</span> <span class='op'>=&gt;</span> <span class='symbol'>:title</span><span class='comma'>,</span> <span class='symbol'>:user</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_current_user'>current_user</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_json'>json</span><span class='period'>.</span><span class='id identifier rubyid_merge!'>merge!</span><span class='lparen'>(</span><span class='symbol'>:entries</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_resources'>resources</span><span class='period'>.</span><span class='id identifier rubyid_as_json'>as_json</span><span class='lparen'>(</span><span class='id identifier rubyid_options_for_media_entries'>options_for_media_entries</span><span class='rparen'>)</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_render'>render</span> <span class='symbol'>:json</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_json'>json</span>
    <span class='rbrace'>}</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Thu Dec 22 13:34:28 2011 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.7.4 (ruby-1.9.2).
</div>

  </body>
</html>
