<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: MetaDatum
  
    &mdash; Documentation by YARD 0.7.5
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '';
  if (relpath != '') relpath += '/';
</script>

  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index (M)</a> &raquo; 
    
    
    <span class="title">MetaDatum</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a id="class_list_link" href="#">Class List</a>
  
    <a id="method_list_link" href="#">Method List</a>
  
    <a id="file_list_link" href="#">File List</a>
  
</div>
      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Class: MetaDatum
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName">ActiveRecord::Base</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">ActiveRecord::Base</li>
          
            <li class="next">MetaDatum</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">app/models/meta_datum.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<h1 id="label-MetaDatum">MetaDatum</h1>

<p>The Association class for relating a Resource (e.g. a MediaEntry) to a
MetaKey and a value for that key.</p>

<p>Values are serialized objects (but should we be using composed_of instead?)</p>


  </div>
</div>
<div class="tags">
  

</div>



  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#keep_original_value-instance_method" title="#keep_original_value (instance method)">- (Object) <strong>keep_original_value</strong> </a>
    

    
  </span>
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute keep_original_value.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#context_valid%3F-instance_method" title="#context_valid? (instance method)">- (Boolean) <strong>context_valid?</strong>(context = MetaContext.core) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#context_warnings-instance_method" title="#context_warnings (instance method)">- (Object) <strong>context_warnings</strong>(context = MetaContext.core) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#deserialized_value-instance_method" title="#deserialized_value (instance method)">- (Object) <strong>deserialized_value</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>some meta_keys don't store values, then the returned value could be a
stored one or dynamically computed working here# TODO deserialized_value
#value.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#meta_key%3D-instance_method" title="#meta_key= (instance method)">- (Object) <strong>meta_key=</strong>(key) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#orig_meta_key%3D-instance_method" title="#orig_meta_key= (instance method)">- (Object) <strong>orig_meta_key=</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#same_value%3F-instance_method" title="#same_value? (instance method)">- (Boolean) <strong>same_value?</strong>(other_value) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_s-instance_method" title="#to_s (instance method)">- (Object) <strong>to_s</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  
  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id="keep_original_value=-instance_method"></span>
      <span id="keep_original_value-instance_method"></span>
      <div class="method_details first">
  <p class="signature first" id="keep_original_value-instance_method">
  
    - (<tt>Object</tt>) <strong>keep_original_value</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute keep_original_value</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


16
17
18</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/meta_datum.rb', line 16</span>

<span class='kw'>def</span> <span class='id identifier rubyid_keep_original_value'>keep_original_value</span>
  <span class='ivar'>@keep_original_value</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="context_valid?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>context_valid?</strong>(context = MetaContext.core) 
  

  
</p><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


207
208
209</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/meta_datum.rb', line 207</span>

<span class='kw'>def</span> <span class='id identifier rubyid_context_valid?'>context_valid?</span><span class='lparen'>(</span><span class='id identifier rubyid_context'>context</span> <span class='op'>=</span> <span class='const'>MetaContext</span><span class='period'>.</span><span class='id identifier rubyid_core'>core</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_context_warnings'>context_warnings</span><span class='lparen'>(</span><span class='id identifier rubyid_context'>context</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="context_warnings-instance_method">
  
    - (<tt>Object</tt>) <strong>context_warnings</strong>(context = MetaContext.core) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


194
195
196
197
198
199
200
201
202
203
204
205</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/meta_datum.rb', line 194</span>

<span class='kw'>def</span> <span class='id identifier rubyid_context_warnings'>context_warnings</span><span class='lparen'>(</span><span class='id identifier rubyid_context'>context</span> <span class='op'>=</span> <span class='const'>MetaContext</span><span class='period'>.</span><span class='id identifier rubyid_core'>core</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_r'>r</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_definition'>definition</span> <span class='op'>=</span> <span class='id identifier rubyid_meta_key'>meta_key</span><span class='period'>.</span><span class='id identifier rubyid_meta_key_definitions'>meta_key_definitions</span><span class='period'>.</span><span class='id identifier rubyid_for_context'>for_context</span><span class='lparen'>(</span><span class='id identifier rubyid_context'>context</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_r'>r</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>can't be blank</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span> <span class='kw'>and</span> <span class='id identifier rubyid_definition'>definition</span><span class='period'>.</span><span class='id identifier rubyid_is_required'>is_required</span>
  <span class='id identifier rubyid_r'>r</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>is too short (min is </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_definition'>definition</span><span class='period'>.</span><span class='id identifier rubyid_length_min'>length_min</span><span class='rbrace'>}</span><span class='tstring_content'> characters)</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_definition'>definition</span><span class='period'>.</span><span class='id identifier rubyid_length_min'>length_min</span> <span class='kw'>and</span> <span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span> <span class='kw'>or</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_definition'>definition</span><span class='period'>.</span><span class='id identifier rubyid_length_min'>length_min</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_r'>r</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>is too long (maximum is </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_definition'>definition</span><span class='period'>.</span><span class='id identifier rubyid_length_max'>length_max</span><span class='rbrace'>}</span><span class='tstring_content'> characters)</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span> <span class='kw'>and</span> <span class='id identifier rubyid_definition'>definition</span><span class='period'>.</span><span class='id identifier rubyid_length_max'>length_max</span> <span class='kw'>and</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>&gt;</span> <span class='id identifier rubyid_definition'>definition</span><span class='period'>.</span><span class='id identifier rubyid_length_max'>length_max</span>
  <span class='comment'># TODO options
</span>  
  <span class='id identifier rubyid_r'>r</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="deserialized_value-instance_method">
  
    - (<tt>Object</tt>) <strong>deserialized_value</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>some meta_keys don't store values, then the returned value could be a
stored one or dynamically computed working here# TODO deserialized_value
#value</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/meta_datum.rb', line 138</span>

<span class='kw'>def</span> <span class='id identifier rubyid_deserialized_value'>deserialized_value</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_meta_key'>meta_key</span><span class='period'>.</span><span class='id identifier rubyid_is_dynamic?'>is_dynamic?</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_meta_key'>meta_key</span><span class='period'>.</span><span class='id identifier rubyid_label'>label</span>
      <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>owner</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>return</span> <span class='id identifier rubyid_media_resource'>media_resource</span><span class='period'>.</span><span class='id identifier rubyid_user'>user</span>
      <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>uploaded at</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>return</span> <span class='id identifier rubyid_media_resource'>media_resource</span><span class='period'>.</span><span class='id identifier rubyid_created_at'>created_at</span> <span class='comment'>#old# .to_formatted_s(:date_time)
</span>      <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>copyright usage</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_copyright'>copyright</span> <span class='op'>=</span> <span class='id identifier rubyid_media_resource'>media_resource</span><span class='period'>.</span><span class='id identifier rubyid_meta_data'>meta_data</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>copyright status</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_deserialized_value'>deserialized_value</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span> <span class='op'>||</span> <span class='const'>Copyright</span><span class='period'>.</span><span class='id identifier rubyid_default'>default</span> <span class='comment'># OPTIMIZE array or single element
</span>        <span class='kw'>return</span> <span class='id identifier rubyid_copyright'>copyright</span><span class='period'>.</span><span class='id identifier rubyid_usage'>usage</span><span class='lparen'>(</span><span class='id identifier rubyid_read_attribute'>read_attribute</span><span class='lparen'>(</span><span class='symbol'>:value</span><span class='rparen'>)</span><span class='rparen'>)</span>
      <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>copyright url</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_copyright'>copyright</span> <span class='op'>=</span> <span class='id identifier rubyid_media_resource'>media_resource</span><span class='period'>.</span><span class='id identifier rubyid_meta_data'>meta_data</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>copyright status</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_deserialized_value'>deserialized_value</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>  <span class='op'>||</span> <span class='const'>Copyright</span><span class='period'>.</span><span class='id identifier rubyid_default'>default</span> <span class='comment'># OPTIMIZE array or single element
</span>        <span class='kw'>return</span> <span class='id identifier rubyid_copyright'>copyright</span><span class='period'>.</span><span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_read_attribute'>read_attribute</span><span class='lparen'>(</span><span class='symbol'>:value</span><span class='rparen'>)</span><span class='rparen'>)</span>
      <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>public access</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>return</span> <span class='id identifier rubyid_media_resource'>media_resource</span><span class='period'>.</span><span class='id identifier rubyid_is_public?'>is_public?</span>
      <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>media type</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>return</span> <span class='id identifier rubyid_media_resource'>media_resource</span><span class='period'>.</span><span class='id identifier rubyid_media_type'>media_type</span>
      <span class='comment'>#when &quot;gps&quot;
</span>      <span class='comment'>#  return media_resource.media_file.meta_data[&quot;GPS&quot;]
</span>    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_meta_key'>meta_key</span><span class='period'>.</span><span class='id identifier rubyid_object_type'>object_type</span>
      <span class='kw'>when</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>MetaCountry</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>return</span> <span class='id identifier rubyid_read_attribute'>read_attribute</span><span class='lparen'>(</span><span class='symbol'>:value</span><span class='rparen'>)</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_klass'>klass</span> <span class='op'>=</span> <span class='id identifier rubyid_meta_key'>meta_key</span><span class='period'>.</span><span class='id identifier rubyid_object_class'>object_class</span>
        <span class='id identifier rubyid_v'>v</span> <span class='op'>=</span> <span class='const'>Array</span><span class='lparen'>(</span><span class='id identifier rubyid_read_attribute'>read_attribute</span><span class='lparen'>(</span><span class='symbol'>:value</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='comment'># OPTIMIZE 0,1,n limits, return single value if it isn't an Array
</span>        <span class='kw'>return</span> <span class='id identifier rubyid_klass'>klass</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='symbol'>:id</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_v'>v</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="meta_key=-instance_method">
  
    - (<tt>Object</tt>) <strong>meta_key=</strong>(key) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


107
108
109
110
111
112
113
114</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/meta_datum.rb', line 107</span>

<span class='kw'>def</span> <span class='id identifier rubyid_meta_key='>meta_key=</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_orig_meta_key'>orig_meta_key</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_key'>key</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'>MetaKey</span>
    <span class='id identifier rubyid_key'>key</span>
  <span class='kw'>else</span>
    <span class='const'>MetaKey</span><span class='period'>.</span><span class='id identifier rubyid_find_or_create_by_label'>find_or_create_by_label</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span><span class='rparen'>)</span>
    <span class='comment'>#new# MetaKey.find_label(key.downcase)
</span>  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="orig_meta_key=-instance_method">
  
    - (<tt>Object</tt>) <strong>orig_meta_key=</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


106</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/meta_datum.rb', line 106</span>

<span class='id identifier rubyid_alias_method'>alias_method</span> <span class='symbol'>:orig_meta_key=</span><span class='comma'>,</span> <span class='symbol'>:meta_key=</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="same_value?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>same_value?</strong>(other_value) 
  

  
</p><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/meta_datum.rb', line 172</span>

<span class='kw'>def</span> <span class='id identifier rubyid_same_value?'>same_value?</span><span class='lparen'>(</span><span class='id identifier rubyid_other_value'>other_value</span><span class='rparen'>)</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_value'>value</span>
    <span class='kw'>when</span> <span class='const'>String</span>
      <span class='id identifier rubyid_value'>value</span> <span class='op'>==</span> <span class='id identifier rubyid_other_value'>other_value</span>
    <span class='kw'>when</span> <span class='const'>Array</span>
      <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>unless</span> <span class='id identifier rubyid_other_value'>other_value</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Array</span><span class='rparen'>)</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>MetaDate</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_other_value'>other_value</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>MetaDate</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='lparen'>(</span><span class='id identifier rubyid_other_value'>other_value</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_free_text'>free_text</span> <span class='op'>==</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_free_text'>free_text</span><span class='rparen'>)</span>
      <span class='kw'>elsif</span> <span class='id identifier rubyid_meta_key'>meta_key</span><span class='period'>.</span><span class='id identifier rubyid_object_type'>object_type</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Keyword</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_referenced_meta_term_ids'>referenced_meta_term_ids</span> <span class='op'>=</span> <span class='const'>Keyword</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='symbol'>:id</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_other_value'>other_value</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:meta_term_id</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_deserialized_value'>deserialized_value</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:meta_term_id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span><span class='period'>.</span><span class='id identifier rubyid_eql?'>eql?</span><span class='lparen'>(</span><span class='id identifier rubyid_referenced_meta_term_ids'>referenced_meta_term_ids</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span><span class='rparen'>)</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span><span class='period'>.</span><span class='id identifier rubyid_eql?'>eql?</span><span class='lparen'>(</span><span class='id identifier rubyid_other_value'>other_value</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>when</span> <span class='const'>NilClass</span>
      <span class='id identifier rubyid_other_value'>other_value</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="to_s-instance_method">
  
    - (<tt>Object</tt>) <strong>to_s</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/meta_datum.rb', line 116</span>

<span class='kw'>def</span> <span class='id identifier rubyid_to_s'>to_s</span>
  <span class='id identifier rubyid_v'>v</span> <span class='op'>=</span> <span class='id identifier rubyid_deserialized_value'>deserialized_value</span>
  <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Array</span><span class='rparen'>)</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_meta_key'>meta_key</span><span class='period'>.</span><span class='id identifier rubyid_object_type'>object_type</span>
      <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>MetaDate</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'> - </span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>, </span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
  <span class='kw'>end</span>
  <span class='comment'># We must force the encoding of the retrieved string, otherwise it gives us the form it deserialized
</span>  <span class='comment'># into ASCII-8BIT, which looks like this: &quot;\xE2\x88\x86G  = \xE2\x88\x86G\xC2\xB0\xE2\x80\x99 +  R T lnK&quot;
</span>  <span class='comment'># Those multibyte characters are useless to us in that form and the encoding mismatch triggers an
</span>  <span class='comment'># EncodingError exception.
</span>  <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_force_encoding'>force_encoding</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>utf-8</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Tue Feb 28 17:17:06 2012 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.7.5 (ruby-1.9.3).
</div>

  </body>
</html>